FIRESTORE SECURITY RULES FOR COMPLETE BOOKING SYSTEM
====================================================

Copy and paste these rules into your Firestore Security Rules editor:

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Public read access for branches, services, and staff
    match /branches/{branchId} {
      allow read: if true;
      allow write: if false; // Admin only - use Firebase Admin SDK or Auth
    }
    
    match /services/{serviceId} {
      allow read: if true;
      allow write: if false; // Admin only
    }
    
    match /staff/{staffId} {
      allow read: if true;
      allow write: if false; // Admin only
    }
    
    // Schedules - public read for availability checking
    match /schedules/{scheduleId} {
      allow read: if true;
      allow write: if false; // Admin only
    }
    
    // Blocked times - public read for availability checking
    match /blocked_times/{blockedTimeId} {
      allow read: if true;
      allow write: if false; // Admin only
    }
    
    // Bookings - read/write through API routes
    match /bookings/{bookingId} {
      allow read: if true; // Allow reading for confirmation
      allow create: if true; // Allow creation through API
      allow update: if false; // Admin only
      allow delete: if false; // Admin only
    }
    
    // Deny all other access by default
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

NOTES:
------
1. Public read access for branches, services, staff, schedules, and blocked_times
2. Anyone can create bookings (validated through API)
3. Only admins can update/delete bookings
4. For production with Firebase Auth, replace admin rules with:
   allow write: if request.auth != null && request.auth.token.admin == true;

PRODUCTION RULES WITH FIREBASE AUTH:
====================================

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Helper function to check if user is admin
    function isAdmin() {
      return request.auth != null && request.auth.token.admin == true;
    }
    
    // Public read, admin write
    match /branches/{branchId} {
      allow read: if true;
      allow write: if isAdmin();
    }
    
    match /services/{serviceId} {
      allow read: if true;
      allow write: if isAdmin();
    }
    
    match /staff/{staffId} {
      allow read: if true;
      allow write: if isAdmin();
    }
    
    match /schedules/{scheduleId} {
      allow read: if true;
      allow write: if isAdmin();
    }
    
    match /blocked_times/{blockedTimeId} {
      allow read: if true;
      allow write: if isAdmin();
    }
    
    // Bookings with validation
    match /bookings/{bookingId} {
      allow read: if true;
      allow create: if request.auth != null 
        && request.resource.data.customerEmail is string
        && request.resource.data.customerName is string
        && request.resource.data.customerPhone is string;
      allow update, delete: if isAdmin();
    }
  }
}

